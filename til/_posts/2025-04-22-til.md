---
layout: post
collection: til
description: >
  2025-04-22 TIL
categories: ["til"]
tags: ["TIL", "Spring"]
date: 2025-04-22 00:00:00
last_modified_at: 2025-05-02 03:39:57
github_issue: 46
github_url: https://github.com/nan0silver/TIL/issues/46
sitemap: false
---

# [TIL] Spring Boot Pageable, PageableDefault μ–΄λ…Έν…μ΄μ…

> π“ **TIL (Today I Learned)**  
> π”— **μ›λ³Έ μ΄μ**: [#46](https://github.com/nan0silver/TIL/issues/46)  
> π“… **μ‘μ„±μΌ**: 2025-04-22  
> π”„ **μµμΆ… μμ •**: 2025λ…„ 05μ›” 02μΌ

---


## π€ μƒλ΅­κ² λ°°μ΄ κ²ƒ

- Spring Boot Paging

  > ν”„λ΅μ νΈμ—μ„ μ»¤λ®¤λ‹ν‹° λ¶€λ¶„μ„ κµ¬ν„ν•λ©° κ²μ‹κΈ€ λ©λ΅μ„ μ΅°νν•  λ•, μ–΄λ–¤ μ‹μΌλ΅ λ°ν™ν•΄μ•Όν•λ”μ§€ μ°Ύμ•„λ³΄λ‹¤ Paginationμ„ μ•κ² λμ—λ‹¤.

  - Spring JPA λΌμ΄λΈλ¬λ¦¬μ Pageableμ„ μ΄μ©ν•λ” λ°©λ²•μ„ μ‚¬μ©ν–λ‹¤.

    - Pageable
      - Spring JPAμ—μ„ DB μΏΌλ¦¬μ— μ‰½κ³  μ μ—°ν•κ² limitμΏΌλ¦¬λ¥Ό μ‚¬μ©ν•  μ μκ² ν•΄μ¤€λ‹¤.
      - νΉν JPAλ¥Ό μ‚¬μ©ν•  λ•, μλ™μΌλ΅ Pageable νƒ€μ…μ λ³€μλ¥Ό λ„κ²¨μ£Όλ©΄ JPAκ°€ DBμ— μ ‘κ·Όν•΄ λ°μ΄ν„°λ¥Ό κ°€μ Έμ¬ λ• μλ™μΌλ΅ limitμ΅°κ±΄μ„ λ¶™μ—¬ λ°μ΄ν„°λ¥Ό κ°€μ Έμ¨λ‹¤.

  - [μ°Έκ³  λΈ”λ΅κ·Έ](https://velog.io/@dani0817/Spring-Boot-%ED%8E%98%EC%9D%B4%EC%A7%95Paging-%EC%A0%81%EC%9A%A9)

## PageableDefault μ–΄λ…Έν…μ΄μ…μ μ—­ν• 

`@PageableDefault(size = 10)` μ–΄λ…Έν…μ΄μ…μ€ λ‹¤μκ³Ό κ°™μ€ μ—­ν• μ„ ν•©λ‹λ‹¤:

1. **κΈ°λ³Έ νμ΄μ§€ ν¬κΈ° μ„¤μ •**: ν΄λΌμ΄μ–ΈνΈκ°€ λ³„λ„μ νμ΄μ§€ ν¬κΈ°(`size` νλΌλ―Έν„°)λ¥Ό μ§€μ •ν•μ§€ μ•μ•μ„ λ• κΈ°λ³Έμ μΌλ΅ νμ΄μ§€λ‹Ή 10κ°μ ν•­λ©μ„ λ°ν™ν•λ„λ΅ μ„¤μ •ν•©λ‹λ‹¤.

2. **κΈ°λ³Έκ°’ μ κ³µ**: ν΄λΌμ΄μ–ΈνΈκ°€ νμ΄μ§• κ΄€λ ¨ νλΌλ―Έν„°λ¥Ό λ…μ‹μ μΌλ΅ μ§€μ •ν•μ§€ μ•μ•μ„ λ• μ‚¬μ©ν•  κΈ°λ³Έκ°’μ„ μ κ³µν•©λ‹λ‹¤.

3. **μ»¨νΈλ΅¤λ¬ λ©”μ„λ“ κ°„μ†ν™”**: λ§¤λ² νμ΄μ§• κ΄€λ ¨ νλΌλ―Έν„°λ¥Ό κ²€μ¦ν•κ³  κΈ°λ³Έκ°’μ„ μ„¤μ •ν•λ” μ½”λ“λ¥Ό μ‘μ„±ν•μ§€ μ•μ•„λ„ λ©λ‹λ‹¤.

## PageableDefaultμ μ£Όμ” μ†μ„±

`@PageableDefault`λ” λ‹¤μκ³Ό κ°™μ€ μ†μ„±μ„ μ§€μ›ν•©λ‹λ‹¤:

```java
@PageableDefault(
    size = 10,       // νμ΄μ§€λ‹Ή ν•­λ© μ (κΈ°λ³Έκ°’: 10)
    page = 0,        // μ‹μ‘ νμ΄μ§€ λ²νΈ (κΈ°λ³Έκ°’: 0, μ²« νμ΄μ§€λ” 0λ¶€ν„° μ‹μ‘)
    sort = {},       // μ •λ ¬ κΈ°μ¤€ ν•„λ“λ…
    direction = Sort.Direction.ASC  // μ •λ ¬ λ°©ν–¥ (κΈ°λ³Έκ°’: μ¤λ¦„μ°¨μ)
)
```

## Pageable κ΄€λ ¨ μ•μ•„μ•Ό ν•  κ°λ…λ“¤

### 1. Pageable μΈν„°νμ΄μ¤

`Pageable`μ€ νμ΄μ§• μ •λ³΄λ¥Ό μΊ΅μν™”ν•λ” Spring Dataμ μΈν„°νμ΄μ¤μ…λ‹λ‹¤. μ£Όμ” λ©”μ„λ“λ” λ‹¤μκ³Ό κ°™μµλ‹λ‹¤:

- `getPageNumber()`: ν„μ¬ νμ΄μ§€ λ²νΈ (0λ¶€ν„° μ‹μ‘)
- `getPageSize()`: νμ΄μ§€ ν¬κΈ°
- `getSort()`: μ •λ ¬ μ •λ³΄
- `getOffset()`: μ „μ²΄ κ²°κ³Όμ—μ„μ μ¤ν”„μ…‹ (μ²« ν•­λ©μ μ„μΉ)
- `next()`, `previous()`, `first()`: λ‹¤μ/μ΄μ „/μ²« νμ΄μ§€μ Pageable κ°μ²΄ μƒμ„±

### 2. Page μΈν„°νμ΄μ¤

`Page<T>`λ” νμ΄μ§•λ κ²°κ³Όλ¥Ό λ‹΄λ” μΈν„°νμ΄μ¤λ΅, λ‹¤μκ³Ό κ°™μ€ λ©”μ„λ“λ¥Ό μ κ³µν•©λ‹λ‹¤:

- `getContent()`: ν„μ¬ νμ΄μ§€μ λ‚΄μ©(λ¦¬μ¤νΈ)
- `getTotalElements()`: μ „μ²΄ ν•­λ© μ
- `getTotalPages()`: μ „μ²΄ νμ΄μ§€ μ
- `getNumber()`: ν„μ¬ νμ΄μ§€ λ²νΈ (0λ¶€ν„° μ‹μ‘)
- `getSize()`: νμ΄μ§€ ν¬κΈ°
- `hasNext()`, `hasPrevious()`: λ‹¤μ/μ΄μ „ νμ΄μ§€ μ΅΄μ¬ μ—¬λ¶€

### 3. μ”μ²­ νλΌλ―Έν„°

ν΄λΌμ΄μ–ΈνΈλ” λ‹¤μκ³Ό κ°™μ€ μ”μ²­ νλΌλ―Έν„°λ¥Ό ν†µν•΄ νμ΄μ§• μ •λ³΄λ¥Ό μ „λ‹¬ν•  μ μμµλ‹λ‹¤:

- `page`: νμ΄μ§€ λ²νΈ (0λ¶€ν„° μ‹μ‘)
- `size`: νμ΄μ§€ ν¬κΈ°
- `sort`: μ •λ ¬ κΈ°μ¤€κ³Ό λ°©ν–¥ (μ: `sort=createdAt,desc`)

### 4. Sort ν΄λμ¤

`Sort`λ” μ •λ ¬ μ •λ³΄λ¥Ό λ‚νƒ€λ‚΄λ” ν΄λμ¤λ΅, λ‹¤μκ³Ό κ°™μ€ λ°©μ‹μΌλ΅ μ‚¬μ©λ©λ‹λ‹¤:

```java
Sort.by(Direction.DESC, "createdAt")
```

μ—¬λ¬ ν•„λ“λ΅ μ •λ ¬ν•  λ•:

```java
Sort.by(
    Sort.Order.desc("createdAt"),
    Sort.Order.asc("title")
)
```

### 5. PageRequest ν΄λμ¤

`PageRequest`λ” `Pageable`μ κµ¬ν„μ²΄λ΅, λ‹¤μκ³Ό κ°™μ΄ μƒμ„±ν•  μ μμµλ‹λ‹¤:

```java
PageRequest.of(0, 10, Sort.by(Direction.DESC, "createdAt"))
```

### 6. JpaRepositoryμ—μ„μ μ‚¬μ©

`JpaRepository`λ” νμ΄μ§•μ„ μ§€μ›ν•λ” λ©”μ„λ“λ¥Ό μ κ³µν•©λ‹λ‹¤:

```java
Page<Entity> findAll(Pageable pageable);
Page<Entity> findByField(String value, Pageable pageable);
```

μ½”λ“μ—μ„ λ³΄μ΄λ” `findAllByOrderByCreatedAtDesc(Pageable pageable)`μ™€ κ°™μ€ λ©”μ„λ“λ” μ΄λ¬ν• ν¨ν„΄μ„ λ”°λ¥΄κ³  μμµλ‹λ‹¤.

### 7. μ»¤μ¤ν…€ μΏΌλ¦¬μ™€ νμ΄μ§•

`@Query` μ–΄λ…Έν…μ΄μ…μΌλ΅ μ‘μ„±ν• JPQL μΏΌλ¦¬μ—μ„λ„ `Pageable` νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•  μ μμµλ‹λ‹¤:

```java
@Query("SELECT p FROM Post p WHERE p.title LIKE %:keyword%")
Page<Post> searchByTitle(@Param("keyword") String keyword, Pageable pageable);
```

## μ‹¤μ  λ™μ‘ λ°©μ‹

μ κ³µλ μ½”λ“μ—μ„ `getPosts` λ©”μ„λ“λ” λ‹¤μκ³Ό κ°™μ΄ λ™μ‘ν•©λ‹λ‹¤:

1. ν΄λΌμ΄μ–ΈνΈκ°€ `/posts?page=1&size=20&sort=viewCount,desc`μ™€ κ°™μ€ μ”μ²­μ„ λ³΄λ‚΄λ©΄, Springμ€ μ΄ νλΌλ―Έν„°λ¥Ό `Pageable` κ°μ²΄λ΅ λ³€ν™ν•©λ‹λ‹¤.

2. λ§μ•½ ν΄λΌμ΄μ–ΈνΈκ°€ `size` νλΌλ―Έν„°λ¥Ό μ§€μ •ν•μ§€ μ•μ•λ‹¤λ©΄, `@PageableDefault(size = 10)`μ— λ”°λΌ κΈ°λ³Έκ°’ 10μ΄ μ‚¬μ©λ©λ‹λ‹¤.

3. `PostService`μ `getPosts` λ©”μ„λ“μ— μ΄ `Pageable` κ°μ²΄κ°€ μ „λ‹¬λκ³ , μ΄κ²ƒμ€ λ‹¤μ‹ `PostRepository`μ μ μ ν• λ©”μ„λ“λ΅ μ „λ‹¬λ©λ‹λ‹¤.

4. λ°μ΄ν„°λ² μ΄μ¤ μΏΌλ¦¬λ” `LIMIT`μ™€ `OFFSET` μ μ„ ν¬ν•¨ν•μ—¬ νμ΄μ§•μ„ κµ¬ν„ν•©λ‹λ‹¤. μλ¥Ό λ“¤μ–΄, `page=1&size=10`μ΄λΌλ©΄ SQLμ—μ„λ” `LIMIT 10 OFFSET 10`κ³Ό κ°™μ΄ λ³€ν™λ©λ‹λ‹¤.

5. κ²°κ³Όλ” `Page<PostDto.ListResponse>` κ°μ²΄λ΅ λ°ν™λλ©°, μ΄ κ°μ²΄λ” ν„μ¬ νμ΄μ§€μ λ‚΄μ©λΏλ§ μ•„λ‹λΌ μ „μ²΄ νμ΄μ§€ μ, μ „μ²΄ ν•­λ© μ λ“±μ λ©”νƒ€λ°μ΄ν„°λ„ ν¬ν•¨ν•©λ‹λ‹¤.

## μμ  μ‘λ‹µ ν•νƒ

API μ‘λ‹µμ€ λ‹¤μκ³Ό κ°™μ€ JSON ν•νƒλ΅ λ°ν™λ©λ‹λ‹¤:

```json
{
  "content": [
    { "id": 1, "title": "κ²μ‹κΈ€ 1", ... },
    { "id": 2, "title": "κ²μ‹κΈ€ 2", ... },
    ...
  ],
  "pageable": {
    "sort": {
      "empty": false,
      "sorted": true,
      "unsorted": false
    },
    "offset": 10,
    "pageNumber": 1,
    "pageSize": 10,
    "paged": true,
    "unpaged": false
  },
  "last": false,
  "totalElements": 42,
  "totalPages": 5,
  "size": 10,
  "number": 1,
  "sort": {
    "empty": false,
    "sorted": true,
    "unsorted": false
  },
  "first": false,
  "numberOfElements": 10,
  "empty": false
}
```

## μµμ ν™” κ³ λ ¤μ‚¬ν•­

1. **μΉ΄μ΄νΈ μΏΌλ¦¬ μµμ ν™”**: ν•­λ©μ΄ λ§μ€ κ²½μ° `totalElements`λ¥Ό κ³„μ‚°ν•κΈ° μ„ν• COUNT μΏΌλ¦¬κ°€ μ„±λ¥μ— μν–¥μ„ μ¤„ μ μμµλ‹λ‹¤. ν•„μ”μ— λ”°λΌ `countQuery` μµμ ν™”λ¥Ό κ³ λ ¤ν•΄μ•Ό ν•©λ‹λ‹¤.

2. **μΈλ±μ¤ ν™μ©**: μ •λ ¬ λ° ν•„ν„°λ§μ— μ‚¬μ©λλ” ν•„λ“μ— μ μ ν• μΈλ±μ¤λ¥Ό μƒμ„±ν•΄μ•Ό ν•©λ‹λ‹¤.

3. **νμ΄μ§€ μ‚¬μ΄μ¦ μ ν•**: ν΄λΌμ΄μ–ΈνΈκ°€ μ§€λ‚μΉκ² ν° νμ΄μ§€ ν¬κΈ°λ¥Ό μ”μ²­ν•μ§€ λ»ν•λ„λ΅ μ ν•ν•  μ μμµλ‹λ‹¤.

## Pageable κ΄€λ ¨ μ¶”κ°€ μ •λ³΄

1. `Pageable` νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•λ” λ©”μ„λ“λ” μλ™μΌλ΅ `spring-data-commons`μ `PageableHandlerMethodArgumentResolver`μ— μν•΄ μ²λ¦¬λ©λ‹λ‹¤.

2. μ• ν”λ¦¬μΌ€μ΄μ… μ „μ²΄μ—μ„ νμ΄μ§• κΈ°λ³Έκ°’μ„ λ³€κ²½ν•λ ¤λ©΄ `application.properties` λλ” `application.yml`μ—μ„ μ„¤μ •ν•  μ μμµλ‹λ‹¤:

```yaml
spring:
  data:
    web:
      pageable:
        default-page-size: 20
        max-page-size: 100
        one-indexed-parameters: true # νμ΄μ§€ λ²νΈλ¥Ό 1λ¶€ν„° μ‹μ‘ν•λ„λ΅ μ„¤μ •
```

3. RESTful APIμ—μ„ νμ΄μ§• μ •λ³΄λ¥Ό μ „λ‹¬ν•λ” λ‹¤λ¥Έ λ°©λ²•μΌλ΅λ” ν—¤λ” λ°©μ‹, κ²½λ΅ λ³€μ λ°©μ‹ λ“±μ΄ μμ§€λ§, Spring Dataλ” κΈ°λ³Έμ μΌλ΅ μΏΌλ¦¬ νλΌλ―Έν„° λ°©μ‹μ„ μ‚¬μ©ν•©λ‹λ‹¤.
