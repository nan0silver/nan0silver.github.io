---
layout: post
title: Algorithm - ë¹ ë¥´ê²Œ ì†Œìˆ˜ ì°¾ëŠ” ë²•
description: >
  ì†Œìˆ˜ë¥¼ ë¹ ë¥´ê²Œ íš¨ìœ¨ì ìœ¼ë¡œ ì°¾ëŠ” ë°©ë²• 3ê°€ì§€ë¥¼ ì•Œì•„ë³´ì
sitemap: false
---

# [Algorithm] ì†Œìˆ˜ ë¹ ë¥´ê²Œ ì°¾ëŠ” ë²•

1. [ê¸°ë³¸ ì†Œìˆ˜ íŒë³„](#1ï¸âƒ£-ê¸°ë³¸-ì†Œìˆ˜-íŒë³„-on)
2. [ì—ë¼í† ìŠ¤í…Œë„¤ìŠ¤ì˜ ì²´](#2ï¸âƒ£-ì—ë¼í† ìŠ¤í…Œë„¤ìŠ¤ì˜-ì²´-on-log-log-n)
3. [Miller-Rabin ì†Œìˆ˜ íŒë³„ë²•](#3ï¸âƒ£-miller-rabin-ì†Œìˆ˜íŒë³„ë²•-olog-n)

---

## 1ï¸âƒ£ ê¸°ë³¸ ì†Œìˆ˜ íŒë³„ (O(âˆšN))

- ì–´ë–¤ ìˆ«ì Nì´ ì†Œìˆ˜ì¸ì§€ íŒë³„í•˜ëŠ” ê°€ì¥ ê¸°ë³¸ì ì¸ ë°©ë²•ì€ 1ê³¼ ìê¸° ìì‹ ì„ ì œì™¸í•œ ë‹¤ë¥¸ ìˆ˜ë¡œ ë‚˜ëˆ„ì–´ë–¨ì–´ì§€ëŠ”ì§€ í™•ì¸í•˜ëŠ” ê²ƒ
- ğŸ”¥ 2ë¶€í„° âˆšNê¹Œì§€ ë‚˜ëˆ„ì–´ë³´ì!
  - ì†Œìˆ˜ê°€ ì•„ë‹ˆë¼ë©´ ì‘ì€ ì•½ìˆ˜ë¥¼ ê°€ì§€ê³  ìˆê¸° ë•Œë¬¸
- ì½”ë“œ ì˜ˆì œ

```java
public class PrimeCheck {
    public static boolean isPrime(int n) {
        if (n < 2) return false;
        for (int i = 2; i <= Math.sqrt(n); i++) {
            if (n % i == 0) return false;
        }
        return true;
    }

    public static void main(String[] args) {
        System.out.println(isPrime(29)); //true
        System.out.println(isPrime(100)); //false
    }
}
```

## 2ï¸âƒ£ ì—ë¼í† ìŠ¤í…Œë„¤ìŠ¤ì˜ ì²´ (O(N log log N))

> ì—¬ëŸ¬ ê°œì˜ ì†Œìˆ˜ë¥¼ ë¹ ë¥´ê²Œ ì°¾ëŠ” ë°©ë²•

- 1ë¶€í„° Nê¹Œì§€ì˜ ìˆ˜ ì¤‘ì—ì„œ ì†Œìˆ˜ë¥¼ ëª¨ë‘ ì°¾ì•„ì•¼ í•˜ëŠ” ê²½ìš°
- ğŸ”¥ ë°©ë²•
  1. 2ë¶€í„° ì‹œì‘í•´ì„œ ë°°ìˆ˜ë“¤ì„ ëª¨ë‘ ì œê±°
  2. ë‚¨ì€ ìˆ˜ë“¤ë§Œ ì†Œìˆ˜ë¡œ íŒë³„
- ì¥ì 
  - í•œ ë²ˆ ê³„ì‚°í•´ ë‘ë©´ íŠ¹ì • ë²”ìœ„ ë‚´ì—ì„œ ë¹ ë¥´ê²Œ ì†Œìˆ˜ ì—¬ë¶€ë¥¼ íŒë³„í•  ìˆ˜ ìˆìŒ.
- ì½”ë“œ ì˜ˆì œ

```java
import java.util.*;

public class SieveOfEratosthenes {
    public static List<Integer> sieveOfEratosthenes(int n) {
        boolean[] isPrime = new boolean[n+1];
        Arrays.fill(isPrime, true);
        isPrime[0] = isPrime[1] = false;

        for (int i = 2; i * i <= n; i++) {
            if (isPrime[i]) {
                for (int j = i*i; j <= n; j += i) {
                    isPrime[j] = false;
                }
            }
        }

        //ì†Œìˆ˜ ë¦¬ìŠ¤íŠ¸ ìƒì„±
    }
}
```

## 3ï¸âƒ£ Miller-Rabin ì†Œìˆ˜íŒë³„ë²• (O(log N))

> ì†Œìˆ˜ íŒë³„ì´ ìì£¼ í•„ìš”í•  ë•Œ

- Nì´ ì—„ì²­ í¬ë©´ ë°€ëŸ¬-ë¼ë¹ˆ ì†Œìˆ˜íŒë³„ë²•ì„ ì‚¬ìš©í•´ì•¼í•¨
  - 10^18ì´ìƒì˜ í° ìˆ˜ê°€ ì†Œìˆ˜ì¸ì§€ íŒë³„í•  ë•Œ
  - ì•”í›„í•™, í•´ì‹œ ê´€ë ¨ ë¬¸ì œì—ì„œ ì‚¬ìš©
- ğŸ”¥ í™•ë¥ ì  ì•Œê³ ë¦¬ì¦˜
- ì½”ë“œ ì˜ˆì œ

```java
import java.util.Random;

public class MillerRabin {
    public static boolean isPrime(long n, int k) { // këŠ” í…ŒìŠ¤íŠ¸ íšŸìˆ˜
        if (n < 2) return false;
        if (n == 2 || n == 3) return true;
        if (n % 2 == 0) return false;

        // n - 1 = 2^r * d í˜•íƒœë¡œ ë³€í™˜
        long d = n - 1;
        int r = 0;
        while (d % 2 == 0) {
            r++;
            d /= 2;
        }

        Random rand = new Random();

        // Miller-Rabin í…ŒìŠ¤íŠ¸ ì‹¤í–‰
        for (int i = 0; i < k; i++) {
            long a = 2 + rand.nextLong(n - 3); // 2 â‰¤ a â‰¤ n-2
            long x = powerMod(a, d, n); // x = a^d % n

            if (x == 1 || x == n - 1) continue;

            boolean isComposite = true;
            for (int j = 0; j < r - 1; j++) {
                x = powerMod(x, 2, n); // x = x^2 % n
                if (x == n - 1) {
                    isComposite = false;
                    break;
                }
            }

            if (isComposite) return false; // í•©ì„±ìˆ˜ íŒë³„
        }

        return true; // ì†Œìˆ˜ íŒë³„
    }

    // (base^exp) % mod ì—°ì‚° (ë¹ ë¥¸ ê±°ë“­ì œê³±)
    private static long powerMod(long base, long exp, long mod) {
        long result = 1;
        base %= mod;

        while (exp > 0) {
            if ((exp & 1) == 1) { // í™€ìˆ˜ ì§€ìˆ˜ ì²˜ë¦¬
                result = (result * base) % mod;
            }
            base = (base * base) % mod; // ì œê³±
            exp >>= 1; // ì§€ìˆ˜ ë‚˜ëˆ„ê¸° 2
        }

        return result;
    }

    public static void main(String[] args) {
        System.out.println(isPrime(15485863, 5));  // true (ì†Œìˆ˜)
        System.out.println(isPrime(1000000007, 5)); // true (ì†Œìˆ˜)
        System.out.println(isPrime(1000000008, 5)); // false (í•©ì„±ìˆ˜)
    }
}
```
