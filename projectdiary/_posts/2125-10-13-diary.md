---
layout: post
collection: project_diary
title: 친구하자 프로젝트 일기 - HTTPS/HTTP Mixed Content 에러 해결
description: >
  배포 후 HTTPS 프론트엔드에서 HTTP 백엔드로 요청이 차단되는 Mixed Content 에러를 Nginx와 Certbot으로 해결한 과정을 정리했습니다.
sitemap: false
---

# [친구하자] HTTPS/HTTP Mixed Content 에러 해결하기

- [1. 문제 발견](#1-문제-발견)
- [2. Mixed Content란?](#2-mixed-content란)
- [3. 해결 방법 선택](#3-해결-방법-선택)
- [4. Nginx + Certbot 설정](#4-nginx--certbot-설정)
- [5. 해결 결과](#5-해결-결과)

## 배포 후 첫 번째 난관: Mixed Content 에러

> 개발 환경에서는 문제없이 동작하던 API 통신이 배포 후 갑자기 차단되기 시작했다. 브라우저 콘솔에 찍힌 에러 메시지는 'Mixed Content'... 대체 뭐가 문제일까?

## 1. 문제 발견

### 상황

로컬 환경에서는 완벽하게 동작하던 프론트엔드와 백엔드 통신이 배포 후 전혀 동작하지 않았다.

```
개발 환경 (정상 동작 ✅):
- Frontend: http://localhost:3000
- Backend:  http://localhost:8080
- 통신: HTTP ↔ HTTP

배포 환경 (통신 차단 ❌):
- Frontend: https://chingoo-frontend.vercel.app (Vercel)
- Backend:  http://43.202.193.103:8080 (EC2)
- 통신: HTTPS ↔ HTTP
```

### 발견한 에러

브라우저 콘솔에 다음과 같은 에러가 발생했다:

- ![에러 이미지](https://github.com/nan0silver/nan0silver.github.io/blob/main/assets/img/blog/2025-10-13-pic1.png?raw=true)

**API 요청 자체가 브라우저에서 차단**되어 백엔드까지 도달조차 하지 못하는 상황이었다.

## 2. Mixed Content란?

### 정의

**Mixed Content**는 HTTPS 페이지에서 HTTP 리소스(이미지, 스크립트, API 등)를 요청할 때 발생하는 보안 문제다.

### 왜 차단될까?

```
HTTP vs HTTPS의 차이:

HTTP (Port 80):
- 평문 통신
- 데이터 암호화 없음
- 중간자 공격(MITM) 취약

HTTPS (Port 443):
- SSL/TLS 암호화 통신
- 데이터 무결성 보장
- 인증서 기반 신뢰
```

HTTPS로 암호화된 페이지에서 HTTP 리소스를 불러오면:

1. **암호화된 통신의 의미가 사라짐** - 일부 데이터가 평문으로 전송
2. **중간자 공격 위험** - HTTP 부분에서 데이터 가로채기/조작 가능
3. **사용자 신뢰 훼손** - 브라우저 보안 경고 표시

따라서 **모던 브라우저들은 기본적으로 Mixed Content를 차단**한다.

### 왜 개발 환경에서는 문제없었나?

```
개발 환경: http://localhost:3000 → http://localhost:8080
→ 둘 다 HTTP, 프로토콜 일치 ✅

배포 환경: https://vercel.app → http://ec2-server
→ HTTPS와 HTTP, 프로토콜 불일치 ❌
```

Vercel은 자동으로 HTTPS를 제공하지만, EC2에 직접 배포한 백엔드는 기본적으로 HTTP로 동작한다. 이 프로토콜 불일치가 문제의 원인이었다.

## 3. 해결 방법 선택

Mixed Content 문제를 해결하려면 백엔드도 HTTPS로 제공해야 한다. 찾아본 방법은 크게 2가지였다:

### 방법 1: AWS Application Load Balancer (ALB)

```
장점:
✅ AWS 콘솔에서 간단하게 설정
✅ SSL 인증서 관리 자동화 (ACM)
✅ 로드 밸런싱, 헬스 체크 등 추가 기능

단점:
❌ 시간당 과금 (약 $0.025/시간 ≈ $18/월)
❌ 데이터 전송량 추가 과금
❌ 토이 프로젝트에는 과한 비용
```

### 방법 2: Nginx + Certbot (선택!)

```
장점:
✅ 완전 무료
✅ Let's Encrypt 무료 SSL 인증서
✅ 가볍고 성능 우수
✅ 리버스 프록시로 추가 활용 가능

단점:
❌ 직접 설정 필요
❌ 인증서 갱신 관리 필요 (자동화 가능)
```

**비용을 고려해 Nginx + Certbot을 선택했다.** 많은 개발자들의 과금 사례를 보고 ALB는 부담스러웠고, Nginx로 충분히 해결 가능한 문제였기 때문이다.

## 4. Nginx + Certbot 설정

### 4.1. 사전 준비
